# Virtual DOM

> ### 가상돔이란, 현재 페이지의 DOM 트리의 VDOM 트리를 만들어 메모리에 저장하고, 변경된 VDOM 과 현재 DOM 의 다른점을 비교하여 변경된 부분만 업데이트 하는 패턴이다. 그리고 변경점을 업데이트하는 과정을 `재조정` 이라한다.

## VDOM 을 사용하는 이유는?

그렇다면 가상돔의 패턴이 필요한 이유는 무엇일까 아래 두가지 이유를 꼽을 수 있다.

👉 효율적인 렌더링\
👉 유지보수 용이성

#### DOM 의 렌더링과정

효율적인 렌더링에 대해 언급하기 전 어떻게 돔이 렌더링되는지 먼저 알아야 그 효율에 대해 이해할 수 있다.

<figure><img src="../.gitbook/assets/image (3).png" alt=""><figcaption><p><a href="https://d2.naver.com/helloworld/59361">https://d2.naver.com/helloworld/59361</a></p></figcaption></figure>

돔이 렌더링 되는 과정은&#x20;

* 렌더링 엔진은 `HTML` 문서를 먼저 파싱하고 `DOM tree` 로 변환한다.
* `CSS` 스타일 요소를 파싱하고 `CSSOM tree` 로 변환한다.&#x20;
* DOM tree 와 CSSOM 트리를 결합해 렌더트리를 만든다
* 렌더트리로 각 노드의 위치과 크리를 계산해 레이아웃을 배치하고
* 레이아웃 계산이 완료되면 실제 화면을 페인팅한다.

돔이 변경되면 위의 렌더링과정이 다시 발생하게 된다.

🚀 효율적인 렌더링

실제로 효율이 얼마나 좋을까 궁금해서 가상돔과 비슷한 환경을 만들어 확인해봤다.

case 1) 변경사항을 바로 DOM 에 반영\
case 2) 변경사항을 모아 문자열(나름의 가상돔)로 만든 후 DOM 에 반영

<figure><img src="../.gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>

굉장히 단순하게 비교했을 때 아래와 같이 시간차가 발생했다.

![](<../.gitbook/assets/image (4).png>)



위에 실험한 코드는 단편적인 예이다. 실제 우리가 만드는 어플리케이션은 훨씬 복잡한 연산을 요구한다. 이런 과정을 VDOM 에 적용시키고 이후에 변경된 사항만 한번에 렌더시킨다면 렌더링의 효율성은 매우 높아질 것이다.



🚀 유지보수의 용이성

* 리액트에서는 JSX 와 VDOM 을 활용하여 보다 유지보수하기 쉬운 개발환경을 제공한다. 이 부분에 대하서는 JSX 에서 언급한 유지보수관점과 동일하기 때문에 자세한 내용은 [링크](jsx.md)로 대신하겠다.



보통 가상돔이 필요한 이유로 중요하게 꼽히는 부분이 바로 **효율적인 렌더링**이다. 하지만, 그보다 <mark style="background-color:yellow;">**더 중요한건 유지보수의 용이성**</mark>이다. 사실 속도만 생각한다면 바닐라로 모두 작성하는 것이 가장 빠르고 가볍다. 그럼 유지보수가 가능한 코드가 될 수 있을까?

애플리케이션은 현실의 문제를 해결하고자 만들어진다. 그리고 현실의 문제는 매 순간 변화하고 다른 요구에 빠르게 대응해야한다. 이게 내가 개발을하는 실질적 목적이기 때문에 유지보수 용이성에 초점을 두고 VDOM 과 JSX 선택이 필연적이라고 생각한다.&#x20;
